@page "/"
@using MediatR
@using Application.Sync.Commands.SyncPlaylists;
@using Application.ConnectService.Commands.GetSpotifyAuthorizeUrl

@inject IMediator Mediator

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.

<SurveyPrompt Title="How is Blazor working for you?" />

<button class="btn btn-primary" @onclick="SendNotification">Send Notification</button>


<h2> Spotify auth url</h2>
<a>@_authUrl</a>
<button class="btn btn-primary" @onclick="GetUrl">GetUrl</button>

@code {
    private string _authUrl = string.Empty;
    
    private async Task GetUrl()
    {
        var response = await Mediator.Send(new GetSpotifyAuthorizeUrl.Request());
        _authUrl = response.Uri;
    }
    
    private async Task SendNotification()
    {
        await Mediator.Send(new SyncPlaylists.Command());
    }
}